# jQuery 源码读后感

大概花了两个多月的时间读了`jQuery`的源码, 受益匪浅.

`jQuery`的文件里是一个 立即执行的匿名函数. 有效防止变量暴露到全局.
```
(function (global, factory) {

})(window, function () {
  // jQuery 方法
})
```
按顺序读, `jQuery`大致按照以下结构来编写代码
1. 先定义了一系列方法, 比如 `push`, `toString`, `slice`等. 防止之后通过多次调用 `[].push`. 节省性能;
2. 定义了 `each`, `extend` 方法, 之后扩展属性, 全部通过`extend`来扩展. 多个类似方法, 比如 `click dbclick`等事件, 则通过 `each`一次性扩展到目标对象上
3. 内部直接引用了 `Sizzle`引擎, 作为`jQuery`的选择器引擎, 里面包含了一堆正则, 方法以及兼容性检查, 来达到每个浏览器中一致的体验. `Sizzle`里包含了多种方式去优化选择器性能.
4. 定义`jQuery`过滤方法. 完善`jQuery`的筛选方法.
5. 定义 `jQuery`的 `Callbacks`以及 `Deferred`对象. 模拟 `Promise`. 构成`jQuery`的回调系统. 之后的 动画, `ajax` 等多处使用该回调系统
6. `jQuery`的`Data`, 缓存. 之后的 `on`, `data`等操作将全部利用到缓存, 将数据缓存到 对象的 `jQuery`属性里
7. 定义部分`css`方法, 以及部分标签的兼容性. `css`的标准属性通过创建一个`dom`来获取其默认值. `jQuery`内部其它地方均通过创建一个 `dom`来查看浏览器的兼容性
8. 定义`jQuery`的 `on`事件. 将事件全部都缓存到对象的`jQuery`属性上, 在事件上仅绑定`jQuery`的队列事件. 触发后队列执行.并且包装了`event`, 构造了`jQuery`自己的 `Event`对象, 达到各个浏览器上的兼容.
9. 标签处理, 克隆, 插入等操作
10. 定义了大部分的`css`方法. 针对浏览器的兼容性对多种`css`创造了钩子函数.
11. `Tween`补间动画, `Animation`动画对象. 利用回调系统, 来创造出一系列过渡动画, 以及动画的执行, 停止等. 并定义了一些基础动画.
12. 获取元素标签的属性, 以及类操作, 表单元素的值获取. 写了相当多的兼容方法.
13. `ajax`, 大部分网络操作, 序列化, 默认参数等. 将`ajax`操作变得更简单.
14. 补充`jQuery`功能, 获取`offset`, `position` 长宽等

`jQuery`里的 `cache`的运用, `Data`缓存数据, `Deferred`的实现, `extend`、`each`的运用, 事件绑定, 都是令人大开眼界